{
  "url": "https://api.github.com/gists/43fb536747da1d8111b9e7b72c13022e",
  "forks_url": "https://api.github.com/gists/43fb536747da1d8111b9e7b72c13022e/forks",
  "commits_url": "https://api.github.com/gists/43fb536747da1d8111b9e7b72c13022e/commits",
  "id": "43fb536747da1d8111b9e7b72c13022e",
  "node_id": "G_kwDOBcuSaNoAIDQzZmI1MzY3NDdkYTFkODExMWI5ZTdiNzJjMTMwMjJl",
  "git_pull_url": "https://gist.github.com/43fb536747da1d8111b9e7b72c13022e.git",
  "git_push_url": "https://gist.github.com/43fb536747da1d8111b9e7b72c13022e.git",
  "html_url": "https://gist.github.com/43fb536747da1d8111b9e7b72c13022e",
  "files": {
    "code.js": {
      "filename": "code.js",
      "type": "application/javascript",
      "language": "JavaScript",
      "raw_url": "https://gist.githubusercontent.com/jade-addin/43fb536747da1d8111b9e7b72c13022e/raw/161503ed68002c246b9d79bc31a86af50b003352/code.js",
      "size": 15999,
      "truncated": false,
      "content": "//Naive Bayes\nlet probabilities={}\nlet select_values=[]\nasync function auto_exec(){\n  // set the tool css\n  Jade.set_css(gist_files('style.css'),\"naive-bayes\")\n  // place the tool html \n  tag(\"tools-body\").innerHTML=gist_files('tool.html')\n  \n  // fill in values from last tool use\n  const tool_data = await jade.read_object_from_workbook(window.active_tool)\n  if(tool_data.outcome_values){\n    select_values = tool_data.outcome_values\n    load_positive_select()\n  }\n\n  console.log(\"select_values\",select_values)\n\n  for(const[key,value] of Object.entries(tool_data)){\n    if(tag(key)){\n      tag(key).value=value\n    }\n  }\n\n \n}\n\nfunction save_inputs(){\n  const values_to_save=get_form_values([\"datasheet\",\"datarange\",\"trainingprecent\",\"predictors\",\"outcome\",\"positive-result\",\"predictionsheet\",\"predictionrange\"])\n  values_to_save.outcome_values=select_values\n  jade.save_object_to_workbook(\n    values_to_save     \n    , window.active_tool)\n\n}\n\nfunction get_form_values(tag_names){\n  const obj={}\n  for(const tag_name of tag_names){\n    obj[tag_name]=tag(tag_name).value\n  }\n  return obj\n}\n\n\nfunction find_outcomes(){\n  console.log(tag(\"outcome\").value)\n  Excel.run(async function(excel){\n    const sheet = excel.workbook.worksheets.getItem(tag(\"datasheet\").value)\n    const datarange = sheet.getRange(tag(\"outcome\").value)\n    datarange.load('values')\n    //sheet.activate()\n    await excel.sync()\n    if(datarange.values[0].length>1){\n      alert(\"The outcome must be a single column.\",\"Error\")\n      return\n    }\n    select_values.length=0// clear the array\n    for(let x=1;x<datarange.values.length;x++){\n      if(datarange.values[x][0] !== null && !select_values.includes(datarange.values[x][0])){\n        select_values.push(datarange.values[x][0])\n      }\n    }\n    switch(select_values.length){\n      case 0:\n       alert(\"Could not find any values in the outcome.\",\"Error\")\n       return\n      case 1:\n       alert(`Could only find a single value (${select_values[0]}) in the outcome.  There must be exactly two values.`,\"Error\")\n       return\n      case 2: //nothing to see Here, move along citizens.\n       break\n      default:\n       alert(`There must be exactly two values in the outcome column. Found the following ${select_values.length}:<br><ul><li>${select_values.join(\"</li><li>\")}</li><ul/>`,\"Error\")\n       return\n     }\n\n    select_values.sort()\n    load_positive_select()\n  })\n}\n\nfunction load_positive_select(){\n  const html=[]\n  let default_chosen=false\n  for(let x=0;x<2;x++){\n    html.push(`<option value=\"${select_values[x]}\"`)\n    if(isNaN(select_values[x])){\n      if(select_values[x].toLowerCase()===\"yes\" || select_values[x].toLowerCase()===\"lived\"){\n        html.push(\" selected\")\n        default_chosen=true\n      }\n    }else{\n      if(select_values[x]==1){ // one or true\n        html.push(\" selected\")\n        default_chosen=true\n      }\n    }\n    html.push(`>${select_values[x]}</option>`)\n  }\n  if(!default_chosen){\n    html[0]=html[0].replace(\"value=\",\"selected value=\")\n  }\n  tag(\"positive-result\").innerHTML=html.join(\"\")\n}\n\nasync function get_address(tag_name){\n  tag('datarange').value=await jade_modules.jet_engine.selected_range_address()\n}\n\nasync function split_data(){\n  // save the defaults for the tool\n  save_inputs()\n\n  Excel.run(async function(excel){\n    const sheet = excel.workbook.worksheets.getItem(tag(\"datasheet\").value)\n    const datarange = sheet.getRange(tag(\"datarange\").value)\n    //datarange.load('columnCount')\n    //sheet.activate()\n    await excel.sync()\n    datarange.getColumnsAfter(1).insert(Excel.InsertShiftDirection.right);\n    const next_col = datarange.getColumnsAfter(1)\n    next_col.load('values')\n    await excel.sync()\n    const train=[[\"Train\"]]\n    for(let x=1;x<next_col.values.length;x++){\n      if(Math.random()*100>parseFloat(tag(\"trainingprecent\").value)){\n        train.push([false])\n      }else{\n        train.push([true])\n      }\n    }\n    next_col.values=train\n    await excel.sync()\n  })\n\n\n}\n\nasync function predict(){\n  // save the defaults for the tool\n  save_inputs()\n  //console.log(\"probabilities\", probabilities)\n  if(Object.keys(probabilities).length===0){\n    //there are no probabilities.  Check to see if they have been saved to the workbook\n    probabilities = await jade.read_object_from_workbook(window.active_tool+\"_probabilities\")\n    // console.log(\"probabilities\",probabilities)\n    // console.log(\"save_key\",window.active_tool+\"_probabilities\")\n    if(Object.keys(probabilities).length===0){\n      alert(\"Could not find a model.  Have you completed steps 1 and 2?\",\"Problem\")\n      return\n    }\n  }\n  const outcomes=[]\n  for(const key of Object.keys(probabilities)){\n    outcomes.push(key)\n  }\n\n  Excel.run(async function(excel){\n    const sheet = excel.workbook.worksheets.getItem(tag(\"predictionsheet\").value)\n    const datarange = sheet.getRange(tag(\"predictionrange\").value)\n    //datarange.load('columnCount')\n    //sheet.activate()\n    await excel.sync()\n    datarange.getColumnsAfter(1).insert(Excel.InsertShiftDirection.right);\n    const next_col = datarange.getColumnsAfter(1)\n    next_col.load('values')\n    datarange.load(\"values\")\n    await excel.sync()\n    const prediction=[[\"Prediction\"]]\n    for(let x=1;x<next_col.values.length;x++){\n      let cum_prob={}\n      for(const outcome of outcomes){\n        cum_prob[outcome]=1\n      }\n      for(let c=0;c<datarange.values[0].length;c++){\n        const token = datarange.values[x][c]\n        //console.log(\"row:\",x,\"col:\",c,\"val:\",datarange.values[x][c])\n        cum_prob[outcomes[0]] = cum_prob[outcomes[0]] * probabilities[outcomes[0]][[token]]\n        cum_prob[outcomes[1]] = cum_prob[outcomes[1]] * probabilities[outcomes[1]][[token]]\n      }\n      if(cum_prob[outcomes[0]]>cum_prob[outcomes[1]]){\n        prediction.push([outcomes[0]])\n      }else{\n        prediction.push([outcomes[1]])\n      }\n\n\n\n      \n    }\n    next_col.values=prediction\n    await excel.sync()\n  })\n\n\n}\n\n\nasync function train_model(){\n  // save the defaults for the tool\n\n  save_inputs()\n  Excel.run(async function(excel){\n    const sheet = excel.workbook.worksheets.getItem(tag(\"datasheet\").value)\n    const predictors = sheet.getRange(tag(\"predictors\").value)\n    const outcome = sheet.getRange(tag(\"outcome\").value)\n    const train = sheet.getRange(tag(\"datarange\").value).getColumnsAfter(1)\n    predictors.load('values')\n    outcome.load('values')\n    train.load('values')\n    sheet.activate()\n\n    let out_sheet = excel.workbook.worksheets.getItemOrNullObject(\"Naive Bayes Results\"); \n\n    await excel.sync()\n    if (out_sheet.isNullObject) {\n      // sheet does not exist yet\n      out_sheet=excel.workbook.worksheets.add(\"Naive Bayes Results\")\n    }else{\n      // clear the sheet\n      out_sheet.getUsedRange().delete(Excel.DeleteShiftDirection.up);\n    }\n    out_sheet.activate()\n    await excel.sync()\n\n    const counts = {};\n    for(let r=1;r<outcome.values.length;r++){\n      if(train.values[r][0]){\n        if(!counts[outcome.values[r][0]]){counts[outcome.values[r][0]]={}}\n        for(let c=0;c<predictors.values[0].length;c++){\n          if(counts[outcome.values[r][0]][predictors.values[r][c]]){\n            counts[outcome.values[r][0]][predictors.values[r][c]] += 1\n          }else{\n            counts[outcome.values[r][0]][predictors.values[r][c]] = 1\n          }\n        }\n      }\n    }\n\n   //console.log(\"sorted uniques\",counts)\n    let row=1\n    probabilities = {}\n    for(const [result,token_counts] of Object.entries(counts)){\n      probabilities[result] = {}\n      const data = []\n      data.push(['Token','Count','Probability'])\n      let sum=0\n\n      //sum the counts for all categories\n      for(const [token,count] of Object.entries(token_counts)){\n        sum += count + .01\n      }\n\n      for(const [token,count] of Object.entries(token_counts)){\n        data.push([token,count,(count+.01)/sum])\n        probabilities[result][token] = (count+.01)/sum\n      }\n     //console.log(\"data\",data)\n      out_sheet.getRangeByIndexes(row, 1, 1, 3).merge(true)\n      out_sheet.getRangeByIndexes(row, 1, 1, 1).values=`Probabilities: ${outcome.values[0][0]}=${result}`\n      out_sheet.getRangeByIndexes(row+1, 1, data.length, 3).values=data\n      jade_modules.jet_engine.border_around(out_sheet, out_sheet.getRangeByIndexes(row+1, 1, data.length, 3),\"Medium\",\"Continuous\",\"Black\")\n      jade_modules.jet_engine.range_format(out_sheet, out_sheet.getRangeByIndexes(row, 1,1,1), \"format/font/bold\",  true)\n      jade_modules.jet_engine.range_format(out_sheet, out_sheet.getRangeByIndexes(row, 1,1,1), \"format/font/italic\",  true)\n      jade_modules.jet_engine.range_format(out_sheet, out_sheet.getRangeByIndexes(row+1, 1, 1, 3), \"format/fill/color\",  \"Maroon\")\n      jade_modules.jet_engine.range_format(out_sheet, out_sheet.getRangeByIndexes(row+1, 1, 1, 3), \"format/font/color\",  \"White\")\n      jade_modules.jet_engine.range_format(out_sheet, out_sheet.getRangeByIndexes(row+1, 1, 1, 3), \"format/font/bold\",  true)\n      console.log(\"token_counts\",token_counts)\n      row += Object.keys(token_counts).length+3\n    }\n    out_sheet.getRangeByIndexes(1, 1, 1, 3).format.autofitColumns();\n    jade_modules.jet_engine.range_format(out_sheet, \"D:D\", \"numberFormat\",  \"0.0000\")\n\n    \n    // format of the confusion matrix\n    jade_modules.jet_engine.range_format(out_sheet, \"F3:H3\", \"format/fill/color\",  \"Maroon\")\n    jade_modules.jet_engine.range_format(out_sheet, \"F3:H3\", \"format/font/color\",  \"White\")\n    jade_modules.jet_engine.range_format(out_sheet, \"F3:H7\", \"format/font/bold\",  true)\n    jade_modules.jet_engine.range_format(out_sheet, \"G6:H7\", \"format/font/bold\",  false)\n    jade_modules.jet_engine.range_format(out_sheet, \"F4:H7\", \"format/horizontalAlignment\",  \"Center\")\n    jade_modules.jet_engine.border_around(out_sheet, \"F3:H7\",\"Medium\",\"Continuous\",\"Black\")\n    out_sheet.getRangeByIndexes(2,5,3,2).values = [\n      [\"Confusion Matrix\",null],\n      [null,\"Predicted\"],\n      [\"Actual\",null],\n    ]\n    out_sheet.getRangeByIndexes(2,5,1,3).merge(true)\n    out_sheet.getRangeByIndexes(3,6,1,2).merge(true)\n\n    // format of the model quality stats\n    jade_modules.jet_engine.range_format(out_sheet, \"J3:K3\", \"format/fill/color\",  \"Maroon\")\n    jade_modules.jet_engine.range_format(out_sheet, \"J3:K3\", \"format/font/color\",  \"White\")\n    jade_modules.jet_engine.range_format(out_sheet, \"J3:K3\", \"format/font/bold\",  true)\n    jade_modules.jet_engine.border_around(out_sheet, \"J3:K6\",\"Medium\",\"Continuous\",\"Black\")\n    out_sheet.getRange(\"J3:K6\").values = [\n      [\"Metric\",\"Value\"],\n      [\"Accuracy\",null],\n      [\"Precision\",null],\n      [\"Recall-Sensitivity\",null],\n    ]\n    jade_modules.jet_engine.range_format(out_sheet, \"K4:K6\", \"numberFormat\",  \"0.00%\")\n\n    // console.log(\"counts\",counts)\n    // console.log(\"probabilities\",probabilities)\n    // console.log(\"save_key\",window.active_tool+\"_probabilities\")\n    jade.save_object_to_workbook(\n      probabilities     \n      , window.active_tool+\"_probabilities\")\n\n    // calculating predictions\n    \n    const predictions={}\n    for(let r=1;r<outcome.values.length;r++){\n\n      if(!train.values[r][0]){\n        // this is not a training value\n        let cum_prob=1\n        let pointer=predictions\n        for(const token of predictors.values[r]){\n\n          cum_prob = cum_prob * probabilities[outcome.values[r][0]][[token]]\n          \n          if(!pointer[token]){pointer[token]={}}\n          pointer=pointer[token]\n        }\n        if(!pointer[outcome.values[r][0]]){\n          pointer[outcome.values[r][0]]={prob:cum_prob, count:0}\n        }\n        pointer[outcome.values[r][0]].count++\n      }\n    }\n\n    console.log(\"predictions\",predictions)\n\n    const confusion={}\n    for(const out of Object.keys(probabilities)){\n      confusion[out]={}\n      for(const out2 of Object.keys(probabilities)){\n        confusion[out][out2]=0\n      }\n    }\n\n    \n    let pri=1 //positive result index\n    let nri=0 //negative result index\n    console.log(\"Object.keys(probabilities)[0]\",Object.keys(probabilities)[0])\n    console.log('tag(\"positive-result\")',tag(\"positive-result\").value)\n    console.log(\"equlaity\",tag(\"positive-result\").value===Object.keys(probabilities)[0])\n    if(tag(\"positive-result\").value===Object.keys(probabilities)[0]){\n      pri=0 //positive result index\n      nri=1 //negative result index\n    }\n    const pr=Object.keys(probabilities)[pri]\n    const nr=Object.keys(probabilities)[nri]\n    console.log(\"positive result index:\", pri)\n\n    compute_confusion(predictions, confusion, counts)\n    console.log(\"confusion\",confusion)\n    \n    const conf_col_head=[[pr,nr]]\n    const conf_row_head=[[pr],[nr]]\n    const confusion_array=[[confusion[pr][pr],confusion[pr][nr]],[confusion[nr][pr],confusion[nr][nr]]]\n\n    // for(const out of Object.keys(probabilities)){\n    //   // conf_row_head.push([out])\n    //   // conf_col_head[0].push(out)\n    //   const temp_array=[]\n    //   for(const out2 of Object.keys(probabilities)){\n    //     temp_array.push(confusion[out][out2])\n    //   }\n    //   confusion_array.push(temp_array)\n    // }\n    \n    //console.log(\"conf_col_head\",conf_col_head)\n    //writing confusion data\n    out_sheet.getRange(\"G5:H5\").values = conf_col_head\n    out_sheet.getRange(\"F6:F7\").values = conf_row_head\n    out_sheet.getRange(\"G6:H7\").values = confusion_array\n    \n    //write out model quality stats\n\n    const tp=confusion_array[0][0]\n    const tn=confusion_array[1][1]\n    const fp=confusion_array[pri][nri]\n    const fn=confusion_array[nri][pri]\n\n    out_sheet.getRange(\"K4:K6\").values = [\n      [(tp + tn)/(tp+tn+fp+fn)],\n      [tp/(tp+fp)],\n      [tp/(tp+fn)]\n    ]\n\n    out_sheet.getRange(\"J3:K3\").format.autofitColumns();\n    excel.sync()\n  })\n}\n\nfunction compute_confusion(obj, confusion, counts){\n   let check_count=0\n  //  console.log(\"at comput confusion\")\n   for(const key of Object.keys(obj)){\n    //  console.log(key)\n    if(obj[key]){\n      // console.log(\"---------------obj[key]\",obj[key])\n      if(obj[key].count !== undefined){\n        // console.log(\"------------count incement check_count\")\n        check_count++\n      }\n      if(obj[key].prob !== undefined){\n        // console.log(\"prob incement check_count\")\n        check_count++\n      }\n    }\n   }\n   if(check_count===4){\n      // we have the final node\n      // console.log(\"---------------in check count = 4\")\n      let winner=Object.entries(obj)[0]\n      let loser=Object.entries(obj)[1]\n      // console.log(\"initial winner:\",winner)\n      // console.log(\"initial loser:\",loser)\n\n      if(loser[1].prob > winner[1].prob){\n        // console.log(\"in winner.loser flipper\")\n        winner=Object.entries(obj)[1]\n        loser=Object.entries(obj)[0]\n      }\n      //confusion[winner[0]][winner[0]] += winner[1][count]\n      // console.log(\"obj\",obj)\n      // console.log(\"winner\",winner)\n      // console.log(\"loser\",loser)\n      //confusion.prediction.actual\n      for(const outcome of Object.keys(counts)){\n        confusion[winner[0]][outcome] += obj[outcome].count \n      }\n   }else{\n    for(const key of Object.keys(obj)){ \n      compute_confusion(obj[key],confusion,counts)\n    }\n   }\n\n\n}\n\nfunction onlyUnique(value, index, self) {\n  return self.indexOf(value) === index;\n}\n\n\nfunction configure_example(){\n\n  Excel.run(async function(excel){\n\n    const sheetname=\"Example Data\"\n    let sheet = excel.workbook.worksheets.getItemOrNullObject(sheetname); \n    await excel.sync()\n    if (sheet.isNullObject) {\n      // sheet does not yet exist, create it\n      sheet=excel.workbook.worksheets.add(sheetname)\n    }else{\n      sheet.getUsedRange().delete()\n    }\n    sheet.activate()\n    await jade_modules.jet_engine.stream_to_range(\"https://jade-addin.github.io/data/titanic.data\",sheet)\n\n    tag(\"datasheet\").value=\"Example Data\"\n    tag(\"trainingprecent\").value=30\n    tag(\"outcome\").value=\"D1:D2202\"\n    tag(\"predictors\").value=\"A1:C2202\"\n    tag(\"datarange\").value=\"A1:D2202\"\n    //tag(\"predictionsheet\").value=\"Example Data\"\n\n  })\n}\n\n\n\n\n\n\n\n"
    },
    "style.css": {
      "filename": "style.css",
      "type": "text/css",
      "language": "CSS",
      "raw_url": "https://gist.githubusercontent.com/jade-addin/43fb536747da1d8111b9e7b72c13022e/raw/7068cde4d17e9f6c8158b5bf818f296d7fefcaa1/style.css",
      "size": 4,
      "truncated": false,
      "content": "/**/"
    },
    "tool.html": {
      "filename": "tool.html",
      "type": "text/html",
      "language": "HTML",
      "raw_url": "https://gist.githubusercontent.com/jade-addin/43fb536747da1d8111b9e7b72c13022e/raw/a3b18c803d049030f99d331f09b1e68fe798c3c0/tool.html",
      "size": 8771,
      "truncated": false,
      "content": "<div class=\"hidden\" id=\"jet-refresh\" style=\"margin-left: .5rem;\"><i title=\"Re-load this tool.\" onclick=\"jade_modules.jet_engine.select_page()\" class=\"fa-solid fa-arrows-rotate\"  cursor:pointer\"></i></div>    \n<div style=\"margin:1rem; text-align: center;\"><div style=\"display:inline-block; text-align: left;\">\n<table style=\"width:100%\" align=\"center\" cellspacing=\"0\" cellpadding=\"4\">\n    <tbody>\n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_table(this.nextElementSibling.firstElementChild)\" colspan=\"2\" class=\"section head\">Example</td>\n            <td class=\"section drop\"><i  title=\"Hide or show this step.\" onclick=\"jade_modules.jet_engine.toggle_table(this)\" class=\"fa-solid fa-chevron-down\"></i></td>\n        </tr>            \n        <tr class=\"hidden\" style=\"background-color: white;\">\n            <td colspan=\"3\">Click the button below to build a sheet called \"Example Data\" and configure this tool to run an analysis based on the data.  You can <a href=\"https://www.youtube.com/watch?v=yIYKR4sgzI8\">watch a video</a> walking you through the process and explaining the basics of the analysis.</td>\n        </tr>            \n        <tr class=\"hidden\">\n            <td colspan=\"3\" align=\"right\"><button id=\"configure-button\" onclick=\"jade_modules.code.configure_example()\">Configure Example</button></td>\n        </tr>            \n    </tbody>\n</table>\n<div style=\"margin-top: 1rem;\" />\n<table style=\"width:100%\" align=\"center\" cellspacing=\"0\" cellpadding=\"4\">\n    <tbody>\n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\" colspan=\"2\" class=\"section head\">1. Split Data Set</td>\n            <td class=\"section drop\"><i  title=\"Hide or show this step.\" onclick=\"jade_modules.jet_engine.toggle_table(this)\" class=\"fa-solid fa-chevron-up\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\"> This step will add a columnn to your data set named \"Train\" with values of true or false based on the \"Training Set %\" you specify below.</td>\n        </tr>            \n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\"  class=\"label\" >Data Sheet:</td>\n            <td><input size=\"6\" type=\"text\" id=\"datasheet\" onfocus=\"jade_modules.jet_engine.default_selected_sheet(this)\"/></td>\n            <td><i title=\"Get the name of the active sheet.\" onclick=\"jade_modules.jet_engine.get_sheet_name('datasheet')\" class=\"fa-solid fa-file\" style=\"color:#777; cursor:pointer\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">This is the name of the worksheet that has the data you will use to build your prediction model</td>\n        </tr>            \n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\"  class=\"label\" >Data Range:</td>\n            <td><input size=\"6\" type=\"text\" id=\"datarange\" onfocus=\"jade_modules.jet_engine.default_selected_range(this)\"/></td>\n            <td><i title=\"Get the address of the selected range.\" onclick=\"jade_modules.jet_engine.get_multicell_address('datarange')\" class=\"fa-solid fa-table\" style=\"color:#777; cursor:pointer\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">This is a reference to your whole dataset, including a header row.</td>\n        </tr>            \n\n        <tr onclick=\"jade_modules.jet_engine.toggle_next_row(this)\" class=\"label\" >\n            <td  onclick=\"jade_modules.jet_engine.toggle_next_row(this)\" class=\"label\" >Training Set %:</td>\n            <td><input size=\"6\" type=\"text\" id=\"trainingprecent\" /></td>\n            <td></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">This is the percent of your data you want to use to train the model.  It is number like 30.</td>\n        </tr>            \n        <tr>\n            <td colspan=\"3\" align=\"right\"><button onclick=\"jade_modules.code.split_data()\">Split Data Set</button></td>\n        </tr>            \n    </tbody>\n</table>\n<div style=\"margin-top: 1rem;\" />\n<table  style=\"width:100%\" align=\"center\" cellspacing=\"0\" cellpadding=\"4\">\n    <tbody>\n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\" colspan=\"2\" class=\"section head\">2. Build & Test the Model</td>\n            <td class=\"section drop\"><i  title=\"Hide or show this step.\" onclick=\"jade_modules.jet_engine.toggle_table(this)\" class=\"fa-solid fa-chevron-up\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">Calcualte token probabilities from the portion of the data set selcted for training in the prior step.</td>\n        </tr>            \n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\"  class=\"label\" >Predictors:</td>\n            <td><input size=\"6\" type=\"text\" id=\"predictors\" onfocus=\"jade_modules.jet_engine.default_selected_range(this)\"/></td>\n            <td><i title=\"Get the data columns from the selected range.\" onclick=\"jade_modules.jet_engine.get_data_column_address('predictors')\" class=\"fa-solid fa-table\" style=\"color:#777; cursor:pointer\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">The range that holds the model input data (independent variables).</td>\n        </tr>            \n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\"  class=\"label\" >Outcome:</td>\n            <td><input size=\"6\" type=\"text\" id=\"outcome\" onchange=\"jade_modules.code.find_outcomes()\" onfocus=\"jade_modules.jet_engine.default_selected_range(this)\"/></td>\n            <td><i title=\"Get the data columns from the selecte range.\" onclick=\"jade_modules.jet_engine.get_data_column_address('outcome')\" class=\"fa-solid fa-table\" style=\"color:#777; cursor:pointer\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">The range that holds the model outcome data (dependent variable).</td>\n        </tr>            \n\n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\"  class=\"label\" >Positive:</td>\n            <td><select id=\"positive-result\"><option>Choose</option></select></td>\n            <td></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">Indicate which outcome represents a positive result.</td>\n        </tr>            \n\n        <tr>\n            <td colspan=\"3\" align=\"right\"><button onclick=\"jade_modules.code.train_model()\">Run Model</button></td>\n        </tr>            \n    </tbody>\n</table>\n<div style=\"margin-top: 1rem;\" />\n<table style=\"width:100%\" align=\"center\" cellspacing=\"0\" cellpadding=\"4\">\n    <tbody>\n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\" colspan=\"2\" class=\"section head\">3. Make Predictions</td>\n            <td class=\"section drop\"><i  title=\"Hide or show this step.\" onclick=\"jade_modules.jet_engine.toggle_table(this)\" class=\"fa-solid fa-chevron-up\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">This step will add a column to a table that has the same predctors as the table used to train the data.</td>\n        </tr>            \n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\"  class=\"label\" >Data Sheet:</td>\n            <td><input size=\"6\" type=\"text\" id=\"predictionsheet\" onfocus=\"jade_modules.jet_engine.default_selected_sheet(this)\"/></td>\n            <td><i title=\"Get the name of the active sheet.\" onclick=\"jade_modules.jet_engine.get_sheet_name('predictionsheet')\" class=\"fa-solid fa-file\" style=\"color:#777; cursor:pointer\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">This is the name of the worksheet that has the data about which you want predictions.</td>\n        </tr>            \n        <tr>\n            <td onclick=\"jade_modules.jet_engine.toggle_next_row(this)\"  class=\"label\" >Data Range:</td>\n            <td><input size=\"6\" type=\"text\" id=\"predictionrange\" onfocus=\"jade_modules.jet_engine.default_selected_range(this)\"/></td>\n            <td><i title=\"Get the address of the selected range.\" onclick=\"jade_modules.jet_engine.get_multicell_address('predictionrange')\" class=\"fa-solid fa-table\" style=\"color:#777; cursor:pointer\"></i></td>\n        </tr>            \n        <tr class=\"hidden note\">\n            <td colspan=\"3\">This is a reference to table of data with your predictions, including a header row.</td>\n        </tr>            \n        <tr>\n            <td colspan=\"3\" align=\"right\"><button onclick=\"jade_modules.code.predict()\">Predict Outcomes</button></td>\n        </tr>            \n    </tbody>\n</table>\n\n\n\n</div></div>"
    }
  },
  "public": true,
  "created_at": "2022-05-02T14:11:50Z",
  "updated_at": "2022-05-09T23:50:00Z",
  "description": "JET: Naive Bayes tool for the JADE Excel Add-in",
  "comments": 0,
  "user": null,
  "comments_url": "https://api.github.com/gists/43fb536747da1d8111b9e7b72c13022e/comments",
  "owner": {
    "login": "jade-addin",
    "id": 97227368,
    "node_id": "U_kgDOBcuSaA",
    "avatar_url": "https://avatars.githubusercontent.com/u/97227368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jade-addin",
    "html_url": "https://github.com/jade-addin",
    "followers_url": "https://api.github.com/users/jade-addin/followers",
    "following_url": "https://api.github.com/users/jade-addin/following{/other_user}",
    "gists_url": "https://api.github.com/users/jade-addin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jade-addin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jade-addin/subscriptions",
    "organizations_url": "https://api.github.com/users/jade-addin/orgs",
    "repos_url": "https://api.github.com/users/jade-addin/repos",
    "events_url": "https://api.github.com/users/jade-addin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jade-addin/received_events",
    "type": "User",
    "site_admin": false
  },
  "forks": [

  ],
  "history": [
    {
      "user": {
        "login": "theGove",
        "id": 24496385,
        "node_id": "MDQ6VXNlcjI0NDk2Mzg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/24496385?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theGove",
        "html_url": "https://github.com/theGove",
        "followers_url": "https://api.github.com/users/theGove/followers",
        "following_url": "https://api.github.com/users/theGove/following{/other_user}",
        "gists_url": "https://api.github.com/users/theGove/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/theGove/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/theGove/subscriptions",
        "organizations_url": "https://api.github.com/users/theGove/orgs",
        "repos_url": "https://api.github.com/users/theGove/repos",
        "events_url": "https://api.github.com/users/theGove/events{/privacy}",
        "received_events_url": "https://api.github.com/users/theGove/received_events",
        "type": "User",
        "site_admin": false
      },
      "version": "18c972acbc83d35748e5a88e09c5e24d053f74a5",
      "committed_at": "2022-05-09T23:49:59Z",
      "change_status": {
        "total": 615,
        "additions": 615,
        "deletions": 0
      },
      "url": "https://api.github.com/gists/43fb536747da1d8111b9e7b72c13022e/18c972acbc83d35748e5a88e09c5e24d053f74a5"
    }
  ],
  "truncated": false
}
